<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Philippine Tax Calculator 2024</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-result {
            animation: slideUp 0.3s ease-out;
        }

        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
    </style>
</head>
<body class="bg-gray-100">
    <main class="container mx-auto px-4 py-8 max-w-4xl">
        <div class="bg-white rounded-xl shadow-lg p-6 md:p-8 transition-all duration-300">
            <h1 class="text-3xl font-bold text-blue-600 mb-6 flex items-center gap-2">
                <i class="fas fa-calculator"></i>
                Philippine Tax Calculator 2024
            </h1>

            <!-- Input Section -->
            <section class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div>
                    <label class="block text-gray-700 mb-2">Monthly Gross Income (PHP)</label>
                    <input type="number" id="grossIncome" 
                           class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                           placeholder="Enter gross income">
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">Monthly Deductions (PHP)</label>
                    <input type="number" id="deductions" 
                           class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                           placeholder="Enter deductions">
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">Non-Deductible Allowances (PHP)</label>
                    <input type="number" id="nonDeductible" 
                           class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                           placeholder="Enter allowances">
                </div>
            </section>

            <!-- Editable Contributions -->
            <section class="mb-8">
                <h2 class="text-xl font-semibold mb-4 text-gray-700">Mandatory Contributions (Editable)</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h3 class="font-medium text-gray-600 mb-2">SSS Contribution</h3>
                        <input type="number" id="sss" 
                               class="w-full bg-transparent text-blue-600 font-bold border-b-2 border-blue-200 focus:border-blue-500 outline-none"
                               step="0.01">
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h3 class="font-medium text-gray-600 mb-2">PhilHealth</h3>
                        <input type="number" id="philhealth" 
                               class="w-full bg-transparent text-blue-600 font-bold border-b-2 border-blue-200 focus:border-blue-500 outline-none"
                               step="0.01">
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h3 class="font-medium text-gray-600 mb-2">Pag-IBIG</h3>
                        <input type="number" id="pagibig" 
                               class="w-full bg-transparent text-blue-600 font-bold border-b-2 border-blue-200 focus:border-blue-500 outline-none"
                               step="0.01">
                    </div>
                </div>
            </section>

            <!-- Results Section -->
            <section class="bg-blue-50 p-6 rounded-lg animate-result hidden" id="results">
                <h2 class="text-xl font-semibold mb-4 text-gray-700">Tax Calculation Results</h2>
                <div class="space-y-4">
                    <div class="flex justify-between items-center">
                        <span>Total Contributions:</span>
                        <span class="font-bold" id="totalContributions">-</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span>Taxable Income:</span>
                        <span class="font-bold" id="taxableIncome">-</span>
                    </div>
                    <div class="flex justify-between items-center text-red-600">
                        <span>Income Tax:</span>
                        <span class="font-bold" id="incomeTax">-</span>
                    </div>
                    <div class="flex justify-between items-center text-green-600">
                        <span>Net Monthly Pay:</span>
                        <span class="font-bold" id="netPay">-</span>
                    </div>
                </div>
            </section>

            <button onclick="calculateTax()" 
                    class="w-full bg-blue-600 text-white py-3 px-6 rounded-lg mt-6
                           hover:bg-blue-700 transition-colors flex items-center justify-center gap-2">
                <i class="fas fa-calculator"></i>
                Calculate Taxes
            </button>
        </div>
    </main>

    <script>
        const TAX_BRACKETS = [
            { min: 0, max: 20833, base: 0, rate: 0 },
            { min: 20833, max: 33333, base: 0, rate: 0.20 },
            { min: 33333, max: 66667, base: 2500, rate: 0.25 },
            { min: 66667, max: 166667, base: 10833.33, rate: 0.30 },
            { min: 166667, max: 666667, base: 40833.33, rate: 0.32 },
            { min: 666667, Infinity, base: 200833.33, rate: 0.35 }
        ];

        function calculateSSS(gross) {
            const salary = Math.min(gross, 30000);
            return Math.min((salary * 0.045), 1350);
        }

        function calculatePhilHealth(gross) {
            if(gross <= 10000) return 450;
            if(gross >= 90000) return 4050;
            return gross * 0.045;
        }

        function calculatePagIBIG(gross) {
            return gross <= 5000 ? gross * 0.02 : Math.min(gross * 0.02, 200);
        }

        function formatMoney(amount) {
            return 'â‚±' + amount.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
        }

        function calculateTax() {
            const gross = parseFloat(document.getElementById('grossIncome').value) || 0;
            const deductions = parseFloat(document.getElementById('deductions').value) || 0;
            const nonDeductible = parseFloat(document.getElementById('nonDeductible').value) || 0;

            // Calculate initial contributions
            const sssValue = calculateSSS(gross);
            const philhealthValue = calculatePhilHealth(gross);
            const pagibigValue = calculatePagIBIG(gross);

            // Set calculated values but preserve manual edits
            document.getElementById('sss').value = sssValue.toFixed(2);
            document.getElementById('philhealth').value = philhealthValue.toFixed(2);
            document.getElementById('pagibig').value = pagibigValue.toFixed(2);

            // Get final contribution values (including any manual edits)
            const sss = parseFloat(document.getElementById('sss').value) || 0;
            const philhealth = parseFloat(document.getElementById('philhealth').value) || 0;
            const pagibig = parseFloat(document.getElementById('pagibig').value) || 0;
            const totalContributions = sss + philhealth + pagibig;

            // Calculate taxable income with non-deductible allowances
            const taxableIncome = (gross - totalContributions - deductions) + nonDeductible;

            // Tax calculation
            const bracket = TAX_BRACKETS.find(b => taxableIncome >= b.min && taxableIncome <= b.max);
            let incomeTax = bracket ? bracket.base + ((taxableIncome - bracket.min) * bracket.rate) : 0;

            // Net pay calculation
            const netPay = gross - totalContributions - incomeTax - deductions + nonDeductible;

            // Update results
            document.getElementById('totalContributions').textContent = formatMoney(totalContributions);
            document.getElementById('taxableIncome').textContent = formatMoney(taxableIncome);
            document.getElementById('incomeTax').textContent = formatMoney(incomeTax);
            document.getElementById('netPay').textContent = formatMoney(netPay);

            // Show results
            document.getElementById('results').classList.remove('hidden');
            window.scrollTo({
                top: document.getElementById('results').offsetTop - 100,
                behavior: 'smooth'
            });
        }
    </script>
</body>
</html>
